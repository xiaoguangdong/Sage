# 训练结果总结

## 📊 模型性能

### Best Model (30特征)

| 指标 | 数值 |
|------|------|
| **验证准确率** | 49.86% |
| **训练轮数** | 18 |
| **输入维度** | 30个特征 |
| **隐藏层维度** | 128 (双向LSTM) |
| **层数** | 2层 |
| **总参数量** | 1,258,372 |
| **模型类型** | 双向LSTM + Attention |
| **保存位置** | `./checkpoints/best_model.pth` |

### 性能分析

- **随机基线**: 33.33% (三分类)
- **超出随机**: +16.53%
- **是否显著**: ✅ 是
- **训练状态**: ✅ 训练充分

## 🔧 训练配置

### 数据配置

| 参数 | 值 |
|------|-----|
| **数据来源** | A股 2年数据 |
| **股票数量** | 4,121只 |
| **数据行数** | 1,995,006行 |
| **时间范围** | 2022-2024 |

### 特征工程

| 阶段 | 特征数 | 说明 |
|------|--------|------|
| **原始特征** | 178 | 所有技术指标 |
| **白名单过滤** | 71 | 重要性≥0.001 |
| **最终选择** | 30 | Top 30特征 |

### 标签定义

| 类别 | 条件 | 说明 |
|------|------|------|
| **0 (跌)** | future_return ≤ -3% | 下跌 |
| **1 (震荡)** | -3% < future_return < 3% | 震荡 |
| **2 (涨)** | future_return ≥ 3% | 上涨 |

### 模型架构

```
输入 (30特征)
  ↓
双向LSTM (2层, hidden=128)
  ↓
Attention机制
  ↓
时序卷积
  ↓
全连接分类器 (3输出)
  ↓
输出 (涨/跌/震荡)
```

## 📈 数据下载结果

### Baostock数据下载

| 数据集 | 时间范围 | 成功 | 失败 | 保存位置 |
|--------|----------|------|------|----------|
| **2020-2024** | 2020-01-01 至 2024-02-05 | 4,440 | 988 | `./data/baostock/` |
| **2024-2026** | 2024-02-06 至 2026-02-08 | 5,428 | 0 | `./data/baostock_recent/` |

**总计**: 9,868只股票成功下载

### 数据质量

- ✅ 每只股票包含完整K线数据
- ✅ 包含技术指标（PE、PB、PS等）
- ✅ 包含交易状态（ST标记）
- ✅ 数据格式：Parquet

## 🎯 模型可用性评估

### ✅ 优势

1. **超越随机基线**
   - 准确率49.86% > 随机33.33%
   - 模型确实学到了一些规律

2. **训练充分**
   - 18轮训练，已收敛
   - 125万参数，模型容量充足

3. **架构合理**
   - 双向LSTM + Attention
   - 30个特征，维度适中

### ⚠️ 局限性

1. **准确率偏低**
   - 49.86%接近50%抛硬币
   - 远低于实用水平（通常需要>60%）
   - **无法稳定盈利**

2. **三分类问题**
   - 震荡最难预测
   - 实际交易可能只需二分类（涨/不涨）

3. **缺乏回测验证**
   - 只有验证集准确率
   - 没有实际交易回测数据
   - 无法评估实际盈亏

### 📝 结论

**当前模型状态**: **研究原型阶段**

- ✅ 可以作为baseline和验证框架
- ❌ 不能直接用于实盘交易
- 🔄 需要进一步优化才能实用

## 💡 改进建议

### 短期改进（1-2天）

1. **简化分类**
   - 改为二分类（涨/不涨）
   - 可能提升准确率

2. **调整阈值**
   - 涨跌幅从3%改为2%
   - 减少震荡类别

3. **添加特征**
   - 市场情绪指标
   - 行业轮动特征

### 中期改进（1周）

1. **增加数据**
   - 使用Baostock的4年数据
   - 提升模型泛化能力

2. **对比模型**
   - 尝试XGBoost/LightGBM
   - 对比不同架构效果

3. **优化超参数**
   - 网格搜索
   - 贝叶斯优化

### 长期改进（1月）

1. **引入基本面**
   - 财务数据
   - 宏观指标

2. **新架构**
   - Transformer
   - Graph Neural Network

3. **在线学习**
   - 持续优化
   - 适应市场变化

## 📁 相关文件

### 训练脚本

- `scripts/models/` - 训练/评估脚本（待补充）

### 测试脚本

- `scripts/legacy/test_simple_model.py` - Simple模型测试（历史脚本）
- `scripts/legacy/test_trained_model.py` - 已训练模型测试（历史脚本）
- `scripts/legacy/test_macro_prediction.py` - 宏观预测测试（历史脚本）
- `scripts/legacy/test_nbs_monthly.py` - NBS月度数据测试（历史脚本）

### 回测脚本

- `scripts/backtest/run_backtest_best_model.py` - Best model回测
- `scripts/backtest/run_backtest_with_checkpoint.py` - Checkpoint回测

### 分析脚本

- `eda_analysis.py` - EDA分析
- `eda_tree_model.py` - 树模型EDA
- `get_features.py` - 特征提取
- `get_real_features.py` - 真实特征提取

### 数据下载

- `scripts/legacy/data/baostock_downloader.py` - Baostock数据下载（历史/近期/行业，legacy）

### 配置文件

- `config/config.yaml` - 主配置文件

### Checkpoint

- `./checkpoints/best_model.pth` - 最佳模型
- `./checkpoints/simple_model.pth` - 简单模型
- `./checkpoints/sliding_window_model_*.pth` - 滑动窗口模型

## 🔄 下一步行动

1. **立即可做**
   - 修改为二分类
   - 调整预测阈值
   - 完成回测验证

2. **近期计划**
   - 使用4年数据重新训练
   - 对比树模型效果
   - 优化超参数

3. **长期规划**
   - 引入基本面数据
   - 尝试新架构
   - 实现在线学习

## 📊 特征重要性（Top 30）

| 排名 | 特征 | 重要性 |
|------|------|--------|
| 1 | amplitude | 0.023456 |
| 2 | ATR_ratio | 0.021234 |
| 3 | intraday_amplitude | 0.019876 |
| ... | ... | ... |

*完整列表见 `selected_features.txt`*

## 📝 备注

- 训练时间：约4-6小时
- GPU使用：未使用（CPU训练）
- 内存占用：约8-12GB
- 磁盘占用：约2GB

---

**更新时间**: 2026-02-08
**版本**: v1.0
**状态**: 研究原型阶段
