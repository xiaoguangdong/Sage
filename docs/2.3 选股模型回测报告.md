# 选股模型回测报告

> 生成日期：2026-02-17
> 模型版本：P0+P1 改进后（标签周期优化 + Early Stopping + IC稳定性过滤 + Regime软分配）

## 1. 回测设置

| 参数 | 值 |
|------|-----|
| 持仓周期 | 20个交易日（月度调仓） |
| 每期选股 | Top 30 等权 |
| 模型类型 | LightGBM（行业中性化标签） |
| IC筛选 | 阈值0.02, IC_IR≥0.3, hit_rate≥55% |
| 标签周期 | (10d, 20d)，权重(0.4, 0.6) |
| 基准 | 沪深300指数 |

### 策略说明

| 策略 | 说明 |
|------|------|
| 单一模型 | 全市场统一训练一个LightGBM，始终满仓Top30 |
| Regime模型 | 按趋势状态(bull/neutral/bear)分别训练专家模型，推理时选对应模型打分，始终满仓Top30 |
| 趋势+单一 | 单一模型选股 + 趋势模型仓位联动（bull=100%, neutral=60%, bear=30%） |
| 趋势+Regime | Regime模型选股 + 趋势模型仓位联动 |

---

## 2. 回测结果汇总

### 2.1 区间一：2021-02 ~ 2024-02（熊市主导）

训练数据：2020年（仅1年）

| 策略 | 累计收益 | Sharpe | 最大回撤 | 胜率 | 期数 |
|------|---------|--------|---------|------|------|
| **单一模型** | -1.85% | 0.06 | -16.80% | 51.4% | 37 |
| Regime模型 | -5.19% | -0.01 | -20.97% | 40.5% | 37 |
| **趋势+单一** | **+0.89%** | 0.08 | **-8.52%** | 51.4% | 37 |
| 趋势+Regime | -0.51% | 0.02 | -10.77% | 40.5% | 37 |
| 沪深300 | **-40.61%** | — | — | — | — |

**分Regime表现（每期平均收益）：**

| 市场状态 | 单一模型 | Regime模型 | 趋势+单一 | 趋势+Regime | 期数 |
|---------|---------|-----------|----------|------------|------|
| bull | -0.29% | -0.33% | -0.29% | -0.33% | 3 |
| neutral | +0.33% | +0.30% | +0.20% | +0.18% | 14 |
| bear | -0.01% | -0.19% | -0.00% | -0.06% | 20 |

### 2.2 区间二：2024-09 ~ 2026-01（牛市主导）

训练数据：2020~2024年（5年）

| 策略 | 累计收益 | Sharpe | 最大回撤 | 胜率 | 期数 |
|------|---------|--------|---------|------|------|
| **单一模型** | **+68.08%** | 1.62 | -12.33% | 68.8% | 16 |
| Regime模型 | +49.17% | 1.37 | -12.49% | 62.5% | 16 |
| 趋势+单一 | +22.24% | 1.11 | **-7.62%** | 68.8% | 16 |
| 趋势+Regime | +14.67% | 0.82 | -9.76% | 62.5% | 16 |
| 沪深300 | +44.88% | — | — | — | — |

**分Regime表现（每期平均收益）：**

| 市场状态 | 单一模型 | Regime模型 | 趋势+单一 | 趋势+Regime | 期数 |
|---------|---------|-----------|----------|------------|------|
| bull | +0.20% | -0.16% | +0.20% | -0.16% | 6 |
| neutral | +2.00% | +1.34% | +1.20% | +0.80% | 6 |
| bear | +11.08% | +9.37% | +3.32% | +2.81% | 4 |

---

## 3. 关键发现

### 3.1 选股Alpha有效性
- **两个区间均大幅跑赢沪深300**：熊市区间超额约39%（-1.85% vs -40.61%），牛市区间超额约23%（+68% vs +45%）
- 模型在极端熊市（2021-2024）中实现了接近零收益，而同期沪深300暴跌40%，说明选股因子具备防御能力

### 3.2 训练数据量的影响
- 2021-02区间仅用2020年1年数据训练，模型在第4轮即早停（几乎没学到有效模式）
- 2024-09区间用5年数据训练，模型训练到290轮，效果显著更好
- **结论：训练数据至少需要3年以上**

### 3.3 趋势仓位联动的价值
- **回撤控制显著**：趋势联动将最大回撤从-16.80%降至-8.52%（熊市区间），从-12.33%降至-7.62%（牛市区间）
- **熊市区间将亏损转为盈利**：单一模型-1.85% → 趋势+单一+0.89%
- **牛市区间牺牲收益换回撤**：+68% → +22%，因为bear状态仅30%仓位但实际收益+11%/期
- **结论：趋势联动适合风险厌恶型配置，需优化bear状态的仓位比例**

### 3.4 单一模型 vs Regime模型
- 两个区间表现接近，Regime模型未展现明显优势
- 熊市区间Regime模型更差（-5% vs -2%），可能因为训练数据不足导致子模型更弱
- 牛市区间单一模型明显优于Regime（+68% vs +49%），Regime模型对配置敏感
- **结论：当前Regime模型的价值有限，需更多数据和更精细的regime划分**

### 3.5 趋势模型配置敏感性（2026-02-17 补充）

将趋势模型配置从默认 (5/8/10) 统一为 (3/5/7) 后，区间二结果变化：

| 策略 | 旧配置(5/8/10) | 新配置(3/5/7) | 变化 |
|------|----------------|---------------|------|
| 单一模型 | +68.08% | +68.08% | 不变 |
| Regime模型 | +68.77% | +49.17% | **-28.5%** |
| 趋势+单一 | +23.65% | +22.24% | -6.0% |
| 趋势+Regime | +21.95% | +14.67% | -33.2% |

状态分布变化：bull 5→6期, bear 5→4期。配置变更同时影响训练标签和推理选择，Regime模型存在双重依赖脆弱性。

### 3.6 Regime训练样本分布问题（2026-02-17 补充）

2020-2024训练期样本分布（基于沪深300趋势标签）：

| 状态 | 天数 | 占比 | 主要来源年份 |
|------|------|------|-------------|
| bear | 509 | 44.1% | 2022(163), 2023(148) |
| neutral | 401 | 34.7% | 2021(107), 2024(95) |
| bull | 245 | 21.2% | 2020(111), 2024(72) |

**核心问题**：等权训练下，2020年bull样本（111天）占bull总量45%，但2020年市场风格与2024年差异巨大，导致牛市专家模型学到陈旧模式。

**解决方案**：时间衰减样本加权（指数衰减，半衰期~2年），使近期数据权重从37%提升至62%。

---

## 4. 已知局限

1. **无交易成本**：未扣除佣金（万2.5）、印花税（千1）、滑点，实际收益会降低约3~5%/年
2. **无涨跌停/停牌处理**：假设所有股票均可自由买卖
3. **无T+1限制**：假设当日买入次日即可卖出
4. **等权配置**：未考虑市值加权或波动率加权
5. **训练数据不滚动**：每个区间只训练一次，未做Walk-Forward滚动重训

---

## 5. 后续优化方向

1. **趋势仓位参数优化**：bear状态30%仓位过于保守，可调整为50%
2. **Walk-Forward滚动重训**：每3~6个月重训模型，适应市场变化
3. **交易成本纳入**：扣除真实成本后评估净收益
4. **多策略融合**：结合动量/价值/质量因子的多策略组合
5. **止损机制**：个股ATR动态止损 + 组合层面回撤降仓
