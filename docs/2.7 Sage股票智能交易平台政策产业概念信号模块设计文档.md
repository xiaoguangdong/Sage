# Sage股票智能交易平台政策产业概念信号模块设计文档

## 1. 模块定位
用于解析**政策/产业/概念**相关文本信息（公告、政策、研报、舆情），产出结构化信号，作为**行业过滤与权重加成**依据。

> 该模块为**可选LLM模块**，不直接触发交易，仅影响信号融合权重或风险过滤。

---

## 2. 输入与输出
**输入**：
- 政策/公告文本（含发布日期、来源、类别）
- 产业研究/研报摘要（可选）
- 概念板块相关新闻（可选）

**输出（结构化标签）**：
```json
{
  "date": "2026-02-13",
  "source": "policy",
  "themes": ["新能源车", "高端制造"],
  "sentiment": "bullish",
  "confidence": 0.74,
  "affected_industries": ["电池", "汽车零部件"],
  "affected_concepts": ["固态电池", "智能驾驶"],
  "window": "1-3M",
  "risk_flags": ["资金过热"]
}
```

---

## 3. 核心流程
1. **文本采集**：政策/公告/研报/新闻  
2. **预处理**：去重、分类、时间对齐  
3. **LLM抽取**：主题/产业/概念/情绪/风险  
4. **规则校验**：敏感词过滤、置信度阈值  
5. **落库与版本**：记录提示词版本与模型版本  

---

## 4. 信号使用规则
- 不得单独触发交易  
- 仅用于：
  - 行业过滤（宏观候选 → LLM共振加权）
  - 权重微调（+/- 5~15%）
  - 风险提示（过热/退潮）

---

## 5. 约束与风险
- **严禁前视**：必须使用**公告发布时间**  
- **可追溯**：保存模型版本、提示词、输入摘要  
- **可降级**：LLM不可用时自动跳过  

---

## 6. 与现有模块的接口
**输入**：文本数据源（`data/llm/policy_raw/`）  
**输出**：结构化标签（`data/llm/policy_labels/`）  
**融合**：`SignalOrchestrator` 读取标签并加权  

---

## 7. 配置建议（示意）
```yaml
llm_policy:
  enabled: true
  provider: "openai_or_local"
  model: "gpt-4o-mini-or-local"
  prompt_version: "v1"
  confidence_threshold: 0.6
  max_daily_docs: 200
```

---

## 8. 测试策略
- 单元测试：模板输出格式  
- 回测验证：是否改善行业轮动与回撤  
- 稳定性：不同年份/不同主题一致性  

---

## Q&A
- Q: 政策/公告来源优先级？  
  A: 待定（后续根据可用数据源确认）。
- Q: LLM本地还是云端？  
  A: 待定（先留作扩展，进入TODO）。
