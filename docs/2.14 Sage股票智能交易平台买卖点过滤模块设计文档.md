# Sage股票智能交易平台买卖点过滤模块设计文档

## 1. 模块定位
在排序候选股票中，进一步过滤不合适的入场时点，输出可执行买入/卖出信号。

---

## 2. 输入 / 输出
**输入**：
- 排序候选股票  
- 技术指标（MA/MACD/波动率）  

**输出**：
```json
{
  "date": "2026-02-13",
  "buy_list": ["600519.SH", "000001.SZ"],
  "sell_list": ["600030.SH"]
}
```

**输出落地（建议）**：
- `data/signals/entry_exit_<YYYYMMDD>.parquet`
- 字段：`trade_date/ts_code/action/score`

---

## 3. 规则基线
**买入过滤**：
- 价格 > MA20  
- 波动率低于阈值  
- MACD 金叉 / 动量确认  

**卖出过滤**：
- 跌破 MA20  
- 止损触发（配置化）  

### 3.1 特征清单（MVP v1）
- `price_ma20_ratio`
- `volatility_5d`
- `macd`, `macd_signal`
- `momentum_20d`

### 3.2 流程图（Mermaid）
```mermaid
flowchart LR
  A["排序候选股"] --> B["规则/模型过滤"]
  B --> C["买入/卖出列表"]
```

---

## 4. 模型增强（可选）
- Logistic Regression 分类器  
- 输出概率置信度  

---

## 5. 与现有代码映射
- `sage_core/models/entry_model.py`  

---

## Q&A
- Q: 是否启用止盈规则？  
  A: 要有可配置，多套规则，多个止盈幅度
