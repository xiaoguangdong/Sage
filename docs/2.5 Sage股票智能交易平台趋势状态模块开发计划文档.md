# Sage股票智能交易平台趋势状态模块开发计划文档

## 目标
实现**稳定可用**的趋势状态判断模块，作为策略门控信号。

---

## 开发步骤
1. **修复现有代码**
   - `trend_model.py` 中 `ma_medium` 赋值错误
   - `trend_model_enhanced.py` 逻辑变量未定义
   - `market_features.py` API/语法问题

2. **统一数据字段**
   - 指数数据统一为 `date/close/amount` 等字段
   - 与全局数据规范对齐

3. **规则基线实现**
   - MA 多头/空头
   - 波动率中位数判定
   - 回撤阈值

4. **置信度与仓位建议**
   - 输出 `confidence` 与 `position_suggestion`

5. **回测验证**
   - 比较“有/无趋势门控”的收益与回撤

---

## 测试计划
- 单元测试：规则判定边界
- 回测测试：年度分段验证
- 稳定性测试：指数切换对比

---

## 风险
- 指数数据缺失
- 波动率指标计算不一致

---

## Q&A
- Q: 趋势模型是否需要多指数加权？
  A: 创业板指数和沪深300加权
- Q: 规则基线是否加入市场广度指标？
  A: 当然加
